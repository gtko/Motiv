---
import Layout from '../../layouts/Layout.astro';
import ProjectCard from '../../components/ProjectCard';

export async function getStaticPaths() {
  // Pour le mode statique, on g√©n√®re quelques exemples
  return [
    { params: { username: 'marie_dubois' } },
    { params: { username: 'lucas_dev' } },
    { params: { username: 'emma_r' } },
    { params: { username: 'antoine_tech' } }
  ];
}

// Simulation des donn√©es utilisateur - √Ä remplacer par des vraies donn√©es depuis la DB
const { username } = Astro.params;

const user = {
  id: '1',
  username: username || 'marie_dubois',
  name: 'Marie Dubois',
  bio: 'D√©veloppeuse passionn√©e par la cr√©ation d\'applications innovantes. Sp√©cialis√©e en React, Node.js et IA. Toujours √† la recherche de nouveaux d√©fis.',
  avatar: null,
  location: 'Paris, France',
  website: 'https://mariedubois.dev',
  github: 'mariedubois',
  twitter: 'marie_dev',
  linkedin: 'mariedubois',
  discord: 'marie#1234',
  totalPoints: 12850,
  monthlyPoints: 2340,
  projectCount: 15,
  joinedDate: 'Janvier 2023',
  lastActive: 'Il y a 2 heures',
  rank: 1,
  badges: [
    { id: '1', name: 'Early Adopter', icon: 'üåü', rarity: 'epic', earnedAt: '2023-01-15' },
    { id: '2', name: 'Project Master', icon: 'üèÜ', rarity: 'legendary', earnedAt: '2023-06-20' },
    { id: '3', name: 'Speed Demon', icon: '‚ö°', rarity: 'rare', earnedAt: '2023-08-10' },
    { id: '4', name: 'Perfect Score', icon: 'üéØ', rarity: 'epic', earnedAt: '2023-09-05' },
    { id: '5', name: 'Fire Streak', icon: 'üî•', rarity: 'rare', earnedAt: '2023-10-01' },
    { id: '6', name: 'Innovation Award', icon: 'üí°', rarity: 'legendary', earnedAt: '2023-11-15' },
    { id: '7', name: 'Community Helper', icon: 'ü§ù', rarity: 'common', earnedAt: '2023-12-01' },
    { id: '8', name: 'Bug Hunter', icon: 'üêõ', rarity: 'rare', earnedAt: '2024-01-20' },
    { id: '9', name: 'Code Wizard', icon: 'üßô', rarity: 'epic', earnedAt: '2024-02-14' },
    { id: '10', name: 'Rising Star', icon: '‚≠ê', rarity: 'common', earnedAt: '2024-03-10' }
  ]
};

const projects = [
  {
    id: '1',
    title: 'TaskFlow Pro',
    description: 'Application SaaS de gestion de t√¢ches avec IA int√©gr√©e pour optimiser la productivit√© des √©quipes',
    type: 'saas',
    status: 'live',
    totalPoints: 850,
    githubStars: 45,
    uniqueVisitors: 1230,
    uptime: 99.9,
    liveUrl: 'https://taskflow.example.com',
    githubUrl: 'https://github.com/example/taskflow',
    user: user,
    tags: ['React', 'Node.js', 'AI', 'SaaS'],
    createdAt: '2024-11-15'
  },
  {
    id: '2',
    title: 'CodeSnippet Manager',
    description: 'Outil de gestion et partage de snippets de code avec synchronisation multi-plateforme',
    type: 'tool',
    status: 'live',
    totalPoints: 720,
    githubStars: 89,
    uniqueVisitors: 456,
    uptime: 100,
    liveUrl: 'https://snippets.example.com',
    githubUrl: 'https://github.com/example/snippets',
    user: user,
    tags: ['Vue.js', 'Firebase', 'PWA'],
    createdAt: '2024-10-20'
  },
  {
    id: '3',
    title: 'Analytics Dashboard',
    description: 'Tableau de bord temps r√©el pour visualiser les m√©triques business avec des graphiques interactifs',
    type: 'saas',
    status: 'live',
    totalPoints: 680,
    githubStars: 67,
    uniqueVisitors: 890,
    uptime: 99.5,
    liveUrl: 'https://analytics.example.com',
    githubUrl: 'https://github.com/example/analytics',
    user: user,
    tags: ['Next.js', 'D3.js', 'PostgreSQL'],
    createdAt: '2024-09-10'
  }
];

const stats = [
  { label: 'Points totaux', value: user.totalPoints.toLocaleString(), icon: 'üèÜ', color: 'purple' },
  { label: 'Ce mois', value: `+${user.monthlyPoints}`, icon: 'üìà', color: 'green' },
  { label: 'Projets', value: user.projectCount, icon: 'üöÄ', color: 'blue' },
  { label: 'Classement', value: `#${user.rank}`, icon: 'ü•á', color: 'yellow' }
];

const activityHistory = [
  { date: 'Aujourd\'hui', activities: [
    { time: '14:32', type: 'badge', content: 'A obtenu le badge "Code Wizard"', points: 100 },
    { time: '10:15', type: 'project', content: 'A mis √† jour TaskFlow Pro', points: 50 },
    { time: '09:45', type: 'comment', content: 'A comment√© sur Space Defenders', points: 10 }
  ]},
  { date: 'Hier', activities: [
    { time: '18:20', type: 'upvote', content: 'A re√ßu 5 upvotes sur Analytics Dashboard', points: 25 },
    { time: '15:10', type: 'visitor', content: 'TaskFlow Pro a atteint 1000 visiteurs', points: 200 }
  ]}
];
---

<Layout title={`${user.name} - Profil`}>
  <!-- Hero Section -->
  <section class="relative min-h-[40vh] flex items-center justify-center overflow-hidden">
    <div class="absolute inset-0 bg-gradient-to-br from-purple-900/30 via-[#0f0f23] to-blue-900/30"></div>
    
    <div class="absolute inset-0">
      <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl animate-float"></div>
      <div class="absolute bottom-1/4 right-1/4 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl animate-float-delayed"></div>
    </div>
    
    <div class="relative z-10 max-w-6xl mx-auto px-6 w-full">
      <div class="flex flex-col md:flex-row items-center gap-8">
        <!-- Avatar -->
        <div class="relative">
          <div class="w-32 h-32 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 p-1">
            <div class="w-full h-full rounded-full bg-[#0f0f23] flex items-center justify-center text-5xl font-bold">
              {user.name.charAt(0)}
            </div>
          </div>
          {user.rank <= 3 && (
            <div class="absolute -top-2 -right-2 text-4xl">
              {user.rank === 1 ? 'ü•á' : user.rank === 2 ? 'ü•à' : 'ü•â'}
            </div>
          )}
        </div>
        
        <!-- User Info -->
        <div class="flex-1 text-center md:text-left">
          <h1 class="text-4xl md:text-5xl font-bold text-white mb-2">{user.name}</h1>
          <p class="text-xl text-purple-400 mb-4">@{user.username}</p>
          <p class="text-gray-300 max-w-2xl mb-6">{user.bio}</p>
          
          <!-- Meta Info -->
          <div class="flex flex-wrap items-center gap-4 text-sm text-gray-400">
            {user.location && (
              <div class="flex items-center gap-1">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
                {user.location}
              </div>
            )}
            <div class="flex items-center gap-1">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              Membre depuis {user.joinedDate}
            </div>
            <div class="flex items-center gap-1">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              Actif {user.lastActive}
            </div>
          </div>
        </div>
        
        <!-- Action Buttons -->
        <div class="flex flex-col gap-3">
          <button class="px-6 py-3 rounded-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-semibold hover:shadow-lg transform hover:scale-105 transition-all">
            Suivre
          </button>
          <button class="px-6 py-3 rounded-full glass-effect border border-white/20 text-white font-semibold hover:bg-white/10 transition-all">
            Message
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Stats Section -->
  <section class="py-8 -mt-16 relative z-20">
    <div class="max-w-6xl mx-auto px-6">
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        {stats.map((stat) => (
          <div class="glass-effect rounded-2xl p-6 text-center">
            <div class="text-3xl mb-2">{stat.icon}</div>
            <div class={`text-3xl font-bold ${
              stat.color === 'purple' ? 'gradient-text' :
              stat.color === 'green' ? 'text-green-400' :
              stat.color === 'blue' ? 'text-blue-400' :
              'text-yellow-400'
            }`}>
              {stat.value}
            </div>
            <div class="text-sm text-gray-400">{stat.label}</div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Social Links -->
  <section class="py-8">
    <div class="max-w-6xl mx-auto px-6">
      <div class="flex items-center justify-center gap-4">
        {user.website && (
          <a href={user.website} target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 px-4 py-2 rounded-full glass-effect hover:bg-white/10 transition-all text-sm">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
            </svg>
            Site web
          </a>
        )}
        {user.github && (
          <a href={`https://github.com/${user.github}`} target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 px-4 py-2 rounded-full glass-effect hover:bg-white/10 transition-all text-sm">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 0C4.477 0 0 4.484 0 10.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0110 4.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.203 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.942.359.31.678.921.678 1.856 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0020 10.017C20 4.484 15.522 0 10 0z" clip-rule="evenodd" />
            </svg>
            GitHub
          </a>
        )}
        {user.twitter && (
          <a href={`https://twitter.com/${user.twitter}`} target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 px-4 py-2 rounded-full glass-effect hover:bg-white/10 transition-all text-sm">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
              <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
            </svg>
            Twitter
          </a>
        )}
        {user.linkedin && (
          <a href={`https://linkedin.com/in/${user.linkedin}`} target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 px-4 py-2 rounded-full glass-effect hover:bg-white/10 transition-all text-sm">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
              <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
            </svg>
            LinkedIn
          </a>
        )}
        {user.discord && (
          <button class="flex items-center gap-2 px-4 py-2 rounded-full glass-effect hover:bg-white/10 transition-all text-sm">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
              <path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"/>
            </svg>
            {user.discord}
          </button>
        )}
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <section class="py-16">
    <div class="max-w-6xl mx-auto px-6">
      <div class="grid lg:grid-cols-3 gap-8">
        <!-- Left Column - Badges & Activity -->
        <div class="lg:col-span-1 space-y-8">
          <!-- Badges -->
          <div class="glass-effect rounded-2xl p-6">
            <h2 class="text-2xl font-bold text-white mb-6">Badges ({user.badges.length})</h2>
            <div class="grid grid-cols-3 gap-4">
              {user.badges.map((badge) => (
                <div class="group cursor-pointer">
                  <div class={`aspect-square rounded-xl p-4 flex items-center justify-center text-3xl transition-all ${
                    badge.rarity === 'legendary' ? 'bg-gradient-to-br from-yellow-500/20 to-orange-500/20 hover:from-yellow-500/30 hover:to-orange-500/30' :
                    badge.rarity === 'epic' ? 'bg-gradient-to-br from-purple-500/20 to-pink-500/20 hover:from-purple-500/30 hover:to-pink-500/30' :
                    badge.rarity === 'rare' ? 'bg-gradient-to-br from-blue-500/20 to-cyan-500/20 hover:from-blue-500/30 hover:to-cyan-500/30' :
                    'bg-white/10 hover:bg-white/20'
                  }`}>
                    {badge.icon}
                  </div>
                  <p class="text-xs text-center mt-2 text-gray-400">{badge.name}</p>
                </div>
              ))}
            </div>
            <button class="mt-6 w-full text-center text-purple-400 hover:text-purple-300 text-sm font-medium">
              Voir tous les badges ‚Üí
            </button>
          </div>
          
          <!-- Recent Activity -->
          <div class="glass-effect rounded-2xl p-6">
            <h2 class="text-2xl font-bold text-white mb-6">Activit√© r√©cente</h2>
            <div class="space-y-6">
              {activityHistory.map((day) => (
                <div>
                  <h3 class="text-sm font-medium text-gray-400 mb-3">{day.date}</h3>
                  <div class="space-y-3">
                    {day.activities.map((activity) => (
                      <div class="flex items-start gap-3">
                        <div class={`w-2 h-2 rounded-full mt-2 flex-shrink-0 ${
                          activity.type === 'badge' ? 'bg-yellow-400' :
                          activity.type === 'project' ? 'bg-purple-400' :
                          activity.type === 'comment' ? 'bg-blue-400' :
                          activity.type === 'upvote' ? 'bg-green-400' :
                          'bg-orange-400'
                        }`}></div>
                        <div class="flex-1">
                          <p class="text-sm text-gray-300">{activity.content}</p>
                          <div class="flex items-center gap-3 mt-1">
                            <span class="text-xs text-gray-500">{activity.time}</span>
                            {activity.points > 0 && (
                              <span class="text-xs text-green-400">+{activity.points} pts</span>
                            )}
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
        
        <!-- Right Column - Projects -->
        <div class="lg:col-span-2">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold text-white">Projets ({projects.length})</h2>
            <select class="px-4 py-2 rounded-lg bg-white/5 border border-white/10 text-white outline-none text-sm">
              <option value="recent">Plus r√©cents</option>
              <option value="popular">Plus populaires</option>
              <option value="points">Plus de points</option>
            </select>
          </div>
          
          <div class="space-y-6">
            {projects.map((project) => (
              <ProjectCard project={project} client:load />
            ))}
          </div>
          
          <button class="mt-8 w-full py-3 rounded-full glass-effect border border-white/20 text-white hover:bg-white/10 transition-all">
            Voir tous les projets
          </button>
        </div>
      </div>
    </div>
  </section>
</Layout>

<style>
  @keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-30px); }
  }
  
  @keyframes float-delayed {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-40px); }
  }
  
  .animate-float {
    animation: float 6s ease-in-out infinite;
  }
  
  .animate-float-delayed {
    animation: float-delayed 8s ease-in-out infinite;
  }
</style>